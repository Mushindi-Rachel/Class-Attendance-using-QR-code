{% extends "student_dashboard.html" %}

{% block content %}

    <h1>Scan QR Code</h1>
    <video id="scanner"></video>
    <script>
        // Check if Instascan is supported
        if (typeof Instascan === 'undefined') {
            console.error('Instascan library is not loaded.');
        } else {
            // Initialize Instascan scanner
            let scanner = new Instascan.Scanner({ video: document.getElementById('scanner') });
            
            // Add listener for QR code scan
            scanner.addListener('scan', function(content) {
                // Redirect to a Django view with the scanned QR code data
                window.location.href = '/process_qr_code?data=' + encodeURIComponent(content);
            });
            
            // Start scanning
            Instascan.Camera.getCameras().then(function(cameras) {
                if (cameras.length > 0) {
                    scanner.start(cameras[0]);
                } else {
                    console.error('No cameras found.');
                }
            }).catch(function(e) {
                console.error('Error accessing cameras:', e);
            });
        }
    </script>

{% endblock %}
